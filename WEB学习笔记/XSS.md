# XSS

## 什么是XSS漏洞

Cross-Site Scripting 简称为“CSS”，为避免与前端叠成样式表的缩写"CSS"冲突，故又称XSS。一般XSS可以分为如下几种常见类型：  
    1.反射性XSS;  
    2.存储型XSS;  
    3.DOM型XSS;

XSS漏洞一直被评估为web漏洞中危害较大的漏洞，在OWASP TOP10的排名中一直属于前三的江湖地位。  
XSS是一种发生在前端浏览器端的漏洞，所以其危害的对象也是前端用户。  
形成XSS漏洞的主要原因是程序对输入和输出没有做合适的处理，导致“精心构造”的字符输出在前端时被浏览器当作有效代码解析执行从而产生危害。  
因此在XSS漏洞的防范上，一般会采用“对输入进行过滤”和“输出进行转义”的方式进行处理:  
  输入过滤：对输入进行过滤，不允许可能导致XSS攻击的字符输入;  
  输出转义：根据输出点的位置对输出到前端的内容进行适当转义;

---

## xss怎么绕过

**过滤--转换**

1. 对于前端的限制，直接抓包重放，或者直接修改html前端代码

2. 改变大小写,比如：`<sCRIPT>AlerT(111)</SriPt>`

3. 进行拼凑,比如：`<sci<script>pt>alert(111)</scri</script>pt>`

4. 使用注释进行干扰：`<scri<!--test-->pt>alert(111)</sc<!--test-->ipt>`



**过滤--编码**

核心思路：后台过滤了特殊字符，比如<script>标签，但是该标签可以被各种编码，后台不一定会过滤，当浏览器对该编码进行识别时，会解码成正常的标签，从而执行

**使用编码时要注意编码在输出点是否会被正常识别**



**关于htmlspecialchars()函数**

htmlspecialchars()函数把预定义的字符转换为html实体

预定义的字符是：

- `&`成为`&amp`

- `"`成为`&quot`

- `'`成为`&#039`

- `<`成为`&lt`

- `>`成为`&gt`



可用的引号类型：

ENT_COMPAT - 默认。仅编码双引号。

ENT_QUOTES - 编码双引号和单引号。

ENT-NOQUOTES - 不编码任何引号。

---

## XSS常见防范措施

**总的原则：输入进行过滤，输出进行转义**

- 过滤：根据业务需求进行过滤，比如输入点要求输入手机号，则只允许输入手机号格式的数字

- 转义：所有输出到前端的数据都根据输入点进行转义，比如输出到html中进行html实体转义，输出到js进行js转义。
